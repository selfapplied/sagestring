<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three Witness Clocks — FEG Visualization</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: monospace;
            background: #000;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }
        svg {
            width: 100%;
            height: 100%;
        }
        :root {
            --delta-color: #ff6b6b;
            --omega-color: #4ecdc4;
            --witness-color: #ffe66d;
        }
    </style>
</head>
<body>
    <svg id="clocks" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">
        <!-- FEG Operators for Three Witness Clocks -->
        
        <!-- Δ (Fast Clock) - pulse, strobe, reactor flux -->
        <feg id="feg-delta" symbol="delta" t="0" string="0"/>
        
        <!-- Ω (Slow Clock) - periodicity, long wave, breathing -->
        <feg id="feg-omega" symbol="omega" t="0" string="0"/>
        
        <!-- W (Witness Clock) - alignment, coherence -->
        <feg id="feg-witness" symbol="witness" t="0" string="0"/>
        
        <!-- Q_wit - alignment operator -->
        <feg id="feg-Qw" symbol="Qw" string="0"/>
        
        <!-- Ambient scope for time -->
        <feg t="0"/>
        
        <!-- Clock Triad Visualization -->
        <g id="witness-hud" transform="translate(100, 100)">
            
            <!-- Ω — The Slow Clock (mouse two) -->
            <!-- Ring whose stroke-width oscillates slowly -->
            <circle id="omega-clock"
                    cx="0" cy="0"
                    r="35"
                    stroke="var(--omega-color)"
                    stroke-width="2"
                    fill="none"
                    opacity="0.8"/>
            
            <!-- Δ — The Fast Clock (mouse one) -->
            <!-- Small circle whose radius oscillates at Δ-frequency -->
            <circle id="delta-clock"
                    cx="0" cy="0"
                    r="10"
                    fill="var(--delta-color)"
                    opacity="0.9"/>
            
            <!-- W — The Witness Clock (mouse three) -->
            <!-- Circle whose opacity follows witness coherence -->
            <circle id="witness-clock"
                    cx="0" cy="0"
                    r="20"
                    fill="var(--witness-color)"
                    opacity="0.2"/>
            
            <!-- Center indicator -->
            <circle cx="0" cy="0" r="2" fill="#fff" opacity="0.5"/>
            
        </g>
        
        <!-- Labels -->
        <g id="labels" transform="translate(100, 100)">
            <text x="-45" y="-50" font-size="10" fill="var(--delta-color)" text-anchor="middle">Δ</text>
            <text x="45" y="-50" font-size="10" fill="var(--omega-color)" text-anchor="middle">Ω</text>
            <text x="0" y="60" font-size="10" fill="var(--witness-color)" text-anchor="middle">W</text>
        </g>
        
        <!-- Status text -->
        <text id="status" x="100" y="180" font-size="8" fill="#666" text-anchor="middle">Initializing...</text>
    </svg>

    <script src="feg-runtime.js"></script>
    <script>
        const svg = document.getElementById('clocks');
        const runtime = new FEGRuntime();
        
        // Initialize runtime from SVG
        runtime.initialize(svg);
        
        // Clock state (updated by trainer)
        let t = 0;
        let delta = { A: 0, w: 0, phi: 0 };
        let omega = { A: 0, w: 0, phi: 0 };
        let witness = { A: 0, w: 0, phi: 0 };
        let Qw = 0;
        
        // Update FEG operators
        function updateFEG() {
            const deltaEl = document.getElementById('feg-delta');
            const omegaEl = document.getElementById('feg-omega');
            const witnessEl = document.getElementById('feg-witness');
            const QwEl = document.getElementById('feg-Qw');
            
            deltaEl.setAttribute('string', 
                `${delta.A.toFixed(3)}*sin(${delta.w.toFixed(3)}*t + ${delta.phi.toFixed(3)})`);
            
            omegaEl.setAttribute('string', 
                `${omega.A.toFixed(3)}*sin(${omega.w.toFixed(3)}*t + ${omega.phi.toFixed(3)})`);
            
            witnessEl.setAttribute('string', 
                `${witness.A.toFixed(3)}*sin(${witness.w.toFixed(3)}*t + ${witness.phi.toFixed(3)})`);
            
            // Qw = alignment between delta and omega
            const deltaVal = runtime.call('delta', { t });
            const omegaVal = runtime.call('omega', { t });
            const alignment = 1 - Math.abs(deltaVal - omegaVal);
            QwEl.setAttribute('string', alignment.toFixed(3));
        }
        
        // Render clocks
        function renderClocks() {
            // Re-register updated operators
            runtime.clear();
            runtime.initialize(svg);
            
            // Update time in scope
            runtime.pushScope(document.createElementNS('http://www.w3.org/2000/svg', 'feg'));
            runtime.scopes[runtime.scopes.length - 1].t = t;
            
            // Evaluate clocks
            const deltaVal = runtime.call('delta', { t });
            const omegaVal = runtime.call('omega', { t });
            const witnessVal = runtime.call('witness', { t });
            const QwVal = runtime.call('Qw', {});
            
            // Update SVG visuals
            const deltaClock = document.getElementById('delta-clock');
            const omegaClock = document.getElementById('omega-clock');
            const witnessClock = document.getElementById('witness-clock');
            const status = document.getElementById('status');
            
            // Δ: radius oscillates
            const deltaRadius = 10 + deltaVal * 5;
            deltaClock.setAttribute('r', Math.max(3, deltaRadius));
            
            // Ω: stroke-width oscillates
            const omegaStroke = 2 + omegaVal * 2;
            omegaClock.setAttribute('stroke-width', Math.max(1, omegaStroke));
            
            // W: opacity follows witness coherence
            const witnessOpacity = 0.2 + QwVal * 0.8;
            witnessClock.setAttribute('opacity', Math.max(0.1, Math.min(1, witnessOpacity)));
            
            // Status
            status.textContent = 
                `t=${t.toFixed(2)} | Δ=${deltaVal.toFixed(2)} | Ω=${omegaVal.toFixed(2)} | W=${QwVal.toFixed(2)}`;
            
            runtime.popScope();
        }
        
        // Simulate trainer updates (demo mode)
        function demoMode() {
            // Simulate three clocks with different frequencies
            delta = { A: 0.8, w: 5.0, phi: 0 };
            omega = { A: 0.6, w: 0.5, phi: Math.PI / 4 };
            witness = { A: 0.4, w: 1.0, phi: Math.PI / 2 };
            
            updateFEG();
            
            function loop() {
                t += 0.016; // ~60fps
                renderClocks();
                requestAnimationFrame(loop);
            }
            
            loop();
        }
        
        // Start demo
        demoMode();
    </script>
</body>
</html>


